Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', backbone='bert_crf', cache_dir='', config_name='', crf_learning_rate=0.001, data_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/', device=device(type='cuda'), do_adv=False, do_eval=False, do_lower_case=True, do_predict=False, do_train=True, enumerate_mode='attention', eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', freeze_backbone_epoch=0, gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-HC', 2: 'B-HP', 3: 'I-HC', 4: 'I-HP', 5: 'O', 6: 'L-HC', 7: 'L-HP', 8: 'U-HC', 9: 'U-HP', 10: '[START]', 11: '[END]'}, id2tag={0: 'product', 1: 'brand'}, if_add_a_self_attention=True, if_merge_by_add=True, label2id={'X': 0, 'B-HC': 1, 'B-HP': 2, 'I-HC': 3, 'I-HP': 4, 'O': 5, 'L-HC': 6, 'L-HP': 7, 'U-HC': 8, 'U-HP': 9, '[START]': 10, '[END]': 11}, learning_rate=3e-05, local_rank=-1, logging_steps=-1, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='/mnt/storage/wubinghong.wbh/deepl/torch_ner/prev_trained_model/bert-base-chinese', n_gpu=1, no_cuda=False, num_train_epochs=10.0, output_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=72, per_gpu_train_batch_size=72, pos_learning_rate=5e-05, predict_checkpoints=0, save_steps=-1, seed=42, tag2id={'product': 0, 'brand': 1}, tagging_rate=1.0, task_name='ecommerce', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-train_bert-base-chinese_128_ecommerce
***** Running training *****
  Num examples = 3988
  Num Epochs = 10
  Instantaneous batch size per GPU = 72
  Total train batch size (w. parallel, distributed & accumulation) = 72
  Gradient Accumulation steps = 1
  Total optimization steps = 560
Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7293 - recall: 0.6370 - f1: 0.6800 - loss: 12.4580 
***** Entity results  *****
******* HC results ********
 acc: 0.7293 - recall: 0.7545 - f1: 0.7417 
******* HP results ********
 acc: 0.0000 - recall: 0.0000 - f1: 0.0000 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7747 - recall: 0.6571 - f1: 0.7110 - loss: 12.6055 
***** Entity results  *****
******* HC results ********
 acc: 0.7747 - recall: 0.7783 - f1: 0.7765 
******* HP results ********
 acc: 0.0000 - recall: 0.0000 - f1: 0.0000 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-56
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-56


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7294 - recall: 0.7983 - f1: 0.7623 - loss: 8.3707 
***** Entity results  *****
******* HC results ********
 acc: 0.7581 - recall: 0.8105 - f1: 0.7834 
******* HP results ********
 acc: 0.5942 - recall: 0.7321 - f1: 0.6560 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7476 - recall: 0.8298 - f1: 0.7866 - loss: 8.1306 
***** Entity results  *****
******* HC results ********
 acc: 0.7869 - recall: 0.8589 - f1: 0.8213 
******* HP results ********
 acc: 0.5556 - recall: 0.6723 - f1: 0.6084 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-112
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-112


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7640 - recall: 0.8150 - f1: 0.7887 - loss: 7.9650 
***** Entity results  *****
******* HC results ********
 acc: 0.7752 - recall: 0.8353 - f1: 0.8041 
******* HP results ********
 acc: 0.6991 - recall: 0.7054 - f1: 0.7022 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7750 - recall: 0.8429 - f1: 0.8075 - loss: 7.7476 
***** Entity results  *****
******* HC results ********
 acc: 0.7867 - recall: 0.8636 - f1: 0.8234 
******* HP results ********
 acc: 0.7073 - recall: 0.7311 - f1: 0.7190 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-168
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-168


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.8134 - recall: 0.7942 - f1: 0.8037 - loss: 7.6052 
***** Entity results  *****
******* HC results ********
 acc: 0.8299 - recall: 0.8040 - f1: 0.8167 
******* HP results ********
 acc: 0.7281 - recall: 0.7411 - f1: 0.7345 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.8252 - recall: 0.8154 - f1: 0.8203 - loss: 7.1645 
***** Entity results  *****
******* HC results ********
 acc: 0.8451 - recall: 0.8372 - f1: 0.8411 
******* HP results ********
 acc: 0.7155 - recall: 0.6975 - f1: 0.7064 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-224
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-224


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7560 - recall: 0.8275 - f1: 0.7902 - loss: 8.3042 
***** Entity results  *****
******* HC results ********
 acc: 0.7630 - recall: 0.8435 - f1: 0.8013 
******* HP results ********
 acc: 0.7155 - recall: 0.7411 - f1: 0.7281 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7759 - recall: 0.8521 - f1: 0.8122 - loss: 7.9917 
***** Entity results  *****
******* HC results ********
 acc: 0.7927 - recall: 0.8775 - f1: 0.8330 
******* HP results ********
 acc: 0.6800 - recall: 0.7143 - f1: 0.6967 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-280
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-280


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7930 - recall: 0.7830 - f1: 0.7880 - loss: 8.2187 
***** Entity results  *****
******* HC results ********
 acc: 0.8115 - recall: 0.7875 - f1: 0.7993 
******* HP results ********
 acc: 0.7025 - recall: 0.7589 - f1: 0.7296 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.8126 - recall: 0.8115 - f1: 0.8120 - loss: 7.6868 
***** Entity results  *****
******* HC results ********
 acc: 0.8372 - recall: 0.8295 - f1: 0.8333 
******* HP results ********
 acc: 0.6855 - recall: 0.7143 - f1: 0.6996 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-336
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-336


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7577 - recall: 0.8220 - f1: 0.7885 - loss: 9.1893 
***** Entity results  *****
******* HC results ********
 acc: 0.7729 - recall: 0.8353 - f1: 0.8029 
******* HP results ********
 acc: 0.6774 - recall: 0.7500 - f1: 0.7119 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7687 - recall: 0.8482 - f1: 0.8065 - loss: 8.6511 
***** Entity results  *****
******* HC results ********
 acc: 0.7957 - recall: 0.8698 - f1: 0.8311 
******* HP results ********
 acc: 0.6304 - recall: 0.7311 - f1: 0.6770 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-392
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-392


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7677 - recall: 0.8275 - f1: 0.7965 - loss: 9.1955 
***** Entity results  *****
******* HC results ********
 acc: 0.7751 - recall: 0.8402 - f1: 0.8063 
******* HP results ********
 acc: 0.7265 - recall: 0.7589 - f1: 0.7424 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7775 - recall: 0.8416 - f1: 0.8083 - loss: 8.7288 
***** Entity results  *****
******* HC results ********
 acc: 0.7932 - recall: 0.8682 - f1: 0.8290 
******* HP results ********
 acc: 0.6860 - recall: 0.6975 - f1: 0.6917 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-448
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-448


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7668 - recall: 0.8234 - f1: 0.7941 - loss: 9.7880 
***** Entity results  *****
******* HC results ********
 acc: 0.7752 - recall: 0.8353 - f1: 0.8041 
******* HP results ********
 acc: 0.7203 - recall: 0.7589 - f1: 0.7391 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7720 - recall: 0.8377 - f1: 0.8035 - loss: 9.2256 
***** Entity results  *****
******* HC results ********
 acc: 0.7904 - recall: 0.8651 - f1: 0.8261 
******* HP results ********
 acc: 0.6667 - recall: 0.6891 - f1: 0.6777 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-504
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-504


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 72


***** Eval results  *****
 acc: 0.7743 - recall: 0.8206 - f1: 0.7968 - loss: 9.7707 
***** Entity results  *****
******* HC results ********
 acc: 0.7854 - recall: 0.8320 - f1: 0.8080 
******* HP results ********
 acc: 0.7143 - recall: 0.7589 - f1: 0.7359 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 72


***** Eval results  *****
 acc: 0.7776 - recall: 0.8377 - f1: 0.8066 - loss: 9.1814 
***** Entity results  *****
******* HC results ********
 acc: 0.8000 - recall: 0.8620 - f1: 0.8299 
******* HP results ********
 acc: 0.6562 - recall: 0.7059 - f1: 0.6802 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-560
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-560


 global_step = 560, average loss = 7.532680286679949
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf
