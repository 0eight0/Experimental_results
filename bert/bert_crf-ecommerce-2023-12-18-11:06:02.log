Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', backbone='bert_crf', cache_dir='', config_name='', crf_learning_rate=0.001, data_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/', device=device(type='cuda'), do_adv=False, do_eval=False, do_lower_case=True, do_predict=False, do_train=True, enumerate_mode='attention', eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', freeze_backbone_epoch=0, gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-HC', 2: 'B-HP', 3: 'I-HC', 4: 'I-HP', 5: 'O', 6: 'L-HC', 7: 'L-HP', 8: 'U-HC', 9: 'U-HP', 10: '[START]', 11: '[END]'}, id2tag={0: 'product', 1: 'brand'}, if_add_a_self_attention=True, if_merge_by_add=True, label2id={'X': 0, 'B-HC': 1, 'B-HP': 2, 'I-HC': 3, 'I-HP': 4, 'O': 5, 'L-HC': 6, 'L-HP': 7, 'U-HC': 8, 'U-HP': 9, '[START]': 10, '[END]': 11}, learning_rate=3e-05, local_rank=-1, logging_steps=-1, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='/mnt/storage/wubinghong.wbh/deepl/torch_ner/prev_trained_model/bert-base-chinese', n_gpu=1, no_cuda=False, num_train_epochs=10.0, output_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=24, pos_learning_rate=5e-05, predict_checkpoints=0, save_steps=-1, seed=42, tag2id={'product': 0, 'brand': 1}, tagging_rate=1.0, task_name='ecommerce', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-train_bert-base-chinese_128_ecommerce
***** Running training *****
  Num examples = 3988
  Num Epochs = 10
  Instantaneous batch size per GPU = 24
  Total train batch size (w. parallel, distributed & accumulation) = 24
  Gradient Accumulation steps = 1
  Total optimization steps = 1670
Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7398 - recall: 0.7552 - f1: 0.7474 - loss: 9.2081 
***** Entity results  *****
******* HC results ********
 acc: 0.7398 - recall: 0.8056 - f1: 0.7713 
******* HP results ********
 acc: 0.7397 - recall: 0.4821 - f1: 0.5838 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7981 - recall: 0.7657 - f1: 0.7816 - loss: 9.0853 
***** Entity results  *****
******* HC results ********
 acc: 0.8073 - recall: 0.8248 - f1: 0.8160 
******* HP results ********
 acc: 0.7162 - recall: 0.4454 - f1: 0.5492 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-167
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-167


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7770 - recall: 0.8192 - f1: 0.7976 - loss: 7.2280 
***** Entity results  *****
******* HC results ********
 acc: 0.7953 - recall: 0.8320 - f1: 0.8132 
******* HP results ********
 acc: 0.6829 - recall: 0.7500 - f1: 0.7149 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7801 - recall: 0.8403 - f1: 0.8091 - loss: 6.9771 
***** Entity results  *****
******* HC results ********
 acc: 0.8023 - recall: 0.8558 - f1: 0.8282 
******* HP results ********
 acc: 0.6667 - recall: 0.7563 - f1: 0.7087 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-334
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-334


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7376 - recall: 0.8484 - f1: 0.7891 - loss: 8.3539 
***** Entity results  *****
******* HC results ********
 acc: 0.7436 - recall: 0.8649 - f1: 0.7997 
******* HP results ********
 acc: 0.7025 - recall: 0.7589 - f1: 0.7296 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7520 - recall: 0.8613 - f1: 0.8029 - loss: 8.1373 
***** Entity results  *****
******* HC results ********
 acc: 0.7662 - recall: 0.8791 - f1: 0.8188 
******* HP results ********
 acc: 0.6741 - recall: 0.7647 - f1: 0.7165 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-501
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-501


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7954 - recall: 0.8108 - f1: 0.8030 - loss: 7.5463 
***** Entity results  *****
******* HC results ********
 acc: 0.8135 - recall: 0.8336 - f1: 0.8234 
******* HP results ********
 acc: 0.6937 - recall: 0.6875 - f1: 0.6906 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.8087 - recall: 0.8246 - f1: 0.8166 - loss: 7.1230 
***** Entity results  *****
******* HC results ********
 acc: 0.8256 - recall: 0.8512 - f1: 0.8382 
******* HP results ********
 acc: 0.7105 - recall: 0.6807 - f1: 0.6953 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-668
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-668


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7772 - recall: 0.8345 - f1: 0.8048 - loss: 8.5664 
***** Entity results  *****
******* HC results ********
 acc: 0.7855 - recall: 0.8567 - f1: 0.8195 
******* HP results ********
 acc: 0.7273 - recall: 0.7143 - f1: 0.7207 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7706 - recall: 0.8442 - f1: 0.8057 - loss: 8.3749 
***** Entity results  *****
******* HC results ********
 acc: 0.7836 - recall: 0.8760 - f1: 0.8272 
******* HP results ********
 acc: 0.6897 - recall: 0.6723 - f1: 0.6809 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-835
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-835


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7871 - recall: 0.8178 - f1: 0.8022 - loss: 9.7508 
***** Entity results  *****
******* HC results ********
 acc: 0.8077 - recall: 0.8303 - f1: 0.8188 
******* HP results ********
 acc: 0.6829 - recall: 0.7500 - f1: 0.7149 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7755 - recall: 0.8272 - f1: 0.8005 - loss: 9.2797 
***** Entity results  *****
******* HC results ********
 acc: 0.8083 - recall: 0.8434 - f1: 0.8255 
******* HP results ********
 acc: 0.6197 - recall: 0.7395 - f1: 0.6743 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1002
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1002


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7764 - recall: 0.8067 - f1: 0.7913 - loss: 10.0204 
***** Entity results  *****
******* HC results ********
 acc: 0.7921 - recall: 0.8287 - f1: 0.8100 
******* HP results ********
 acc: 0.6875 - recall: 0.6875 - f1: 0.6875 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7835 - recall: 0.8194 - f1: 0.8010 - loss: 9.6115 
***** Entity results  *****
******* HC results ********
 acc: 0.8047 - recall: 0.8496 - f1: 0.8265 
******* HP results ********
 acc: 0.6610 - recall: 0.6555 - f1: 0.6582 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1169
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1169


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7900 - recall: 0.8108 - f1: 0.8003 - loss: 11.0729 
***** Entity results  *****
******* HC results ********
 acc: 0.7978 - recall: 0.8320 - f1: 0.8145 
******* HP results ********
 acc: 0.7429 - recall: 0.6964 - f1: 0.7189 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.8023 - recall: 0.8233 - f1: 0.8127 - loss: 10.4333 
***** Entity results  *****
******* HC results ********
 acc: 0.8170 - recall: 0.8512 - f1: 0.8337 
******* HP results ********
 acc: 0.7143 - recall: 0.6723 - f1: 0.6926 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1336
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1336


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7849 - recall: 0.8122 - f1: 0.7984 - loss: 11.9008 
***** Entity results  *****
******* HC results ********
 acc: 0.7981 - recall: 0.8336 - f1: 0.8155 
******* HP results ********
 acc: 0.7091 - recall: 0.6964 - f1: 0.7027 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7872 - recall: 0.8233 - f1: 0.8049 - loss: 11.0554 
***** Entity results  *****
******* HC results ********
 acc: 0.8050 - recall: 0.8512 - f1: 0.8274 
******* HP results ********
 acc: 0.6838 - recall: 0.6723 - f1: 0.6780 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1503
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1503


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7790 - recall: 0.8136 - f1: 0.7959 - loss: 12.1580 
***** Entity results  *****
******* HC results ********
 acc: 0.7943 - recall: 0.8336 - f1: 0.8135 
******* HP results ********
 acc: 0.6930 - recall: 0.7054 - f1: 0.6991 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7880 - recall: 0.8272 - f1: 0.8072 - loss: 11.3748 
***** Entity results  *****
******* HC results ********
 acc: 0.8053 - recall: 0.8527 - f1: 0.8283 
******* HP results ********
 acc: 0.6891 - recall: 0.6891 - f1: 0.6891 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1670
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1670


 global_step = 1670, average loss = 5.038275238238052
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf
