Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', backbone='bert_crf', cache_dir='', config_name='', crf_learning_rate=0.001, data_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/', device=device(type='cuda'), do_adv=False, do_eval=False, do_lower_case=True, do_predict=False, do_train=True, enumerate_mode='attention', eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', freeze_backbone_epoch=0, gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-HC', 2: 'B-HP', 3: 'I-HC', 4: 'I-HP', 5: 'O', 6: 'L-HC', 7: 'L-HP', 8: 'U-HC', 9: 'U-HP', 10: '[START]', 11: '[END]'}, id2tag={0: 'product', 1: 'brand'}, if_add_a_self_attention=True, if_merge_by_add=True, label2id={'X': 0, 'B-HC': 1, 'B-HP': 2, 'I-HC': 3, 'I-HP': 4, 'O': 5, 'L-HC': 6, 'L-HP': 7, 'U-HC': 8, 'U-HP': 9, '[START]': 10, '[END]': 11}, learning_rate=3e-05, local_rank=-1, logging_steps=-1, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='/mnt/storage/wubinghong.wbh/deepl/torch_ner/prev_trained_model/bert-base-chinese', n_gpu=1, no_cuda=False, num_train_epochs=10.0, output_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=48, per_gpu_train_batch_size=48, pos_learning_rate=5e-05, predict_checkpoints=0, save_steps=-1, seed=42, tag2id={'product': 0, 'brand': 1}, tagging_rate=1.0, task_name='ecommerce', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-train_bert-base-chinese_128_ecommerce
***** Running training *****
  Num examples = 3988
  Num Epochs = 10
  Instantaneous batch size per GPU = 48
  Total train batch size (w. parallel, distributed & accumulation) = 48
  Gradient Accumulation steps = 1
  Total optimization steps = 840
Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7242 - recall: 0.6940 - f1: 0.7088 - loss: 11.1583 
***** Entity results  *****
******* HC results ********
 acc: 0.7253 - recall: 0.7875 - f1: 0.7551 
******* HP results ********
 acc: 0.7000 - recall: 0.1875 - f1: 0.2958 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7644 - recall: 0.7134 - f1: 0.7380 - loss: 10.9788 
***** Entity results  *****
******* HC results ********
 acc: 0.7648 - recall: 0.8016 - f1: 0.7827 
******* HP results ********
 acc: 0.7568 - recall: 0.2353 - f1: 0.3590 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-84
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-84


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7219 - recall: 0.8053 - f1: 0.7613 - loss: 8.4129 
***** Entity results  *****
******* HC results ********
 acc: 0.7318 - recall: 0.8270 - f1: 0.7765 
******* HP results ********
 acc: 0.6638 - recall: 0.6875 - f1: 0.6754 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7433 - recall: 0.8338 - f1: 0.7859 - loss: 8.0306 
***** Entity results  *****
******* HC results ********
 acc: 0.7598 - recall: 0.8682 - f1: 0.8104 
******* HP results ********
 acc: 0.6417 - recall: 0.6471 - f1: 0.6444 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-168
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-168


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7628 - recall: 0.8275 - f1: 0.7939 - loss: 8.3394 
***** Entity results  *****
******* HC results ********
 acc: 0.7766 - recall: 0.8418 - f1: 0.8079 
******* HP results ********
 acc: 0.6885 - recall: 0.7500 - f1: 0.7179 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7815 - recall: 0.8521 - f1: 0.8153 - loss: 7.9950 
***** Entity results  *****
******* HC results ********
 acc: 0.8060 - recall: 0.8698 - f1: 0.8367 
******* HP results ********
 acc: 0.6569 - recall: 0.7563 - f1: 0.7031 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-252
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-252


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.8166 - recall: 0.8053 - f1: 0.8109 - loss: 7.5540 
***** Entity results  *****
******* HC results ********
 acc: 0.8390 - recall: 0.8155 - f1: 0.8271 
******* HP results ********
 acc: 0.7059 - recall: 0.7500 - f1: 0.7273 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.8245 - recall: 0.8181 - f1: 0.8213 - loss: 7.0735 
***** Entity results  *****
******* HC results ********
 acc: 0.8565 - recall: 0.8326 - f1: 0.8443 
******* HP results ********
 acc: 0.6718 - recall: 0.7395 - f1: 0.7040 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-336
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-336


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7983 - recall: 0.7928 - f1: 0.7955 - loss: 8.2852 
***** Entity results  *****
******* HC results ********
 acc: 0.8098 - recall: 0.8138 - f1: 0.8118 
******* HP results ********
 acc: 0.7308 - recall: 0.6786 - f1: 0.7037 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.8020 - recall: 0.8325 - f1: 0.8170 - loss: 7.7868 
***** Entity results  *****
******* HC results ********
 acc: 0.8233 - recall: 0.8667 - f1: 0.8444 
******* HP results ********
 acc: 0.6754 - recall: 0.6471 - f1: 0.6609 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-420
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-420


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7781 - recall: 0.8095 - f1: 0.7935 - loss: 8.4363 
***** Entity results  *****
******* HC results ********
 acc: 0.7981 - recall: 0.8270 - f1: 0.8123 
******* HP results ********
 acc: 0.6723 - recall: 0.7143 - f1: 0.6926 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7901 - recall: 0.8377 - f1: 0.8132 - loss: 7.9430 
***** Entity results  *****
******* HC results ********
 acc: 0.8151 - recall: 0.8682 - f1: 0.8408 
******* HP results ********
 acc: 0.6504 - recall: 0.6723 - f1: 0.6612 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-504
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-504


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7668 - recall: 0.8234 - f1: 0.7941 - loss: 9.2693 
***** Entity results  *****
******* HC results ********
 acc: 0.7754 - recall: 0.8534 - f1: 0.8125 
******* HP results ********
 acc: 0.7115 - recall: 0.6607 - f1: 0.6852 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7642 - recall: 0.8482 - f1: 0.8040 - loss: 8.9062 
***** Entity results  *****
******* HC results ********
 acc: 0.7735 - recall: 0.8791 - f1: 0.8229 
******* HP results ********
 acc: 0.7043 - recall: 0.6807 - f1: 0.6923 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-588
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-588


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.8000 - recall: 0.8178 - f1: 0.8088 - loss: 9.5789 
***** Entity results  *****
******* HC results ********
 acc: 0.8115 - recall: 0.8369 - f1: 0.8240 
******* HP results ********
 acc: 0.7339 - recall: 0.7143 - f1: 0.7240 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7918 - recall: 0.8364 - f1: 0.8135 - loss: 9.0347 
***** Entity results  *****
******* HC results ********
 acc: 0.8081 - recall: 0.8620 - f1: 0.8342 
******* HP results ********
 acc: 0.6975 - recall: 0.6975 - f1: 0.6975 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-672
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-672


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7801 - recall: 0.8192 - f1: 0.7992 - loss: 10.2054 
***** Entity results  *****
******* HC results ********
 acc: 0.7919 - recall: 0.8402 - f1: 0.8153 
******* HP results ********
 acc: 0.7117 - recall: 0.7054 - f1: 0.7085 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7793 - recall: 0.8455 - f1: 0.8110 - loss: 9.5491 
***** Entity results  *****
******* HC results ********
 acc: 0.7935 - recall: 0.8698 - f1: 0.8299 
******* HP results ********
 acc: 0.6967 - recall: 0.7143 - f1: 0.7054 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-756
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-756


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 48


***** Eval results  *****
 acc: 0.7794 - recall: 0.8206 - f1: 0.7995 - loss: 10.4964 
***** Entity results  *****
******* HC results ********
 acc: 0.7919 - recall: 0.8402 - f1: 0.8153 
******* HP results ********
 acc: 0.7080 - recall: 0.7143 - f1: 0.7111 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 48


***** Eval results  *****
 acc: 0.7767 - recall: 0.8469 - f1: 0.8103 - loss: 9.8606 
***** Entity results  *****
******* HC results ********
 acc: 0.7913 - recall: 0.8698 - f1: 0.8287 
******* HP results ********
 acc: 0.6935 - recall: 0.7227 - f1: 0.7078 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-840
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-840


 global_step = 840, average loss = 6.672668830269859
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf
