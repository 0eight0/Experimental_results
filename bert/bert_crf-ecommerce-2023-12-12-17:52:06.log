Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', backbone='bert_crf', cache_dir='', config_name='', crf_learning_rate=0.001, data_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/', device=device(type='cuda'), do_adv=False, do_eval=False, do_lower_case=True, do_predict=False, do_train=True, enumerate_mode='attention', eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', freeze_backbone_epoch=1, gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-HC', 2: 'B-HP', 3: 'I-HC', 4: 'I-HP', 5: 'O', 6: 'L-HC', 7: 'L-HP', 8: 'U-HC', 9: 'U-HP', 10: '[START]', 11: '[END]'}, id2tag={0: 'product', 1: 'brand'}, if_add_a_self_attention=True, if_merge_by_add=True, label2id={'X': 0, 'B-HC': 1, 'B-HP': 2, 'I-HC': 3, 'I-HP': 4, 'O': 5, 'L-HC': 6, 'L-HP': 7, 'U-HC': 8, 'U-HP': 9, '[START]': 10, '[END]': 11}, learning_rate=3e-05, local_rank=-1, logging_steps=-1, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='/mnt/storage/wubinghong.wbh/deepl/torch_ner/prev_trained_model/bert-base-chinese', n_gpu=1, no_cuda=False, num_train_epochs=10.0, output_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=24, per_gpu_train_batch_size=24, pos_learning_rate=5e-05, predict_checkpoints=0, save_steps=-1, seed=42, tag2id={'product': 0, 'brand': 1}, tagging_rate=1.0, task_name='ecommerce', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-train_bert-base-chinese_128_ecommerce
***** Running training *****
  Num examples = 3988
  Num Epochs = 10
  Instantaneous batch size per GPU = 24
  Total train batch size (w. parallel, distributed & accumulation) = 24
  Gradient Accumulation steps = 1
  Total optimization steps = 1670
Backbone bert_crf param is freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.0105 - recall: 0.0236 - f1: 0.0145 - loss: 63.3767 
***** Entity results  *****
******* HC results ********
 acc: 0.0107 - recall: 0.0280 - f1: 0.0154 
******* HP results ********
 acc: 0.0000 - recall: 0.0000 - f1: 0.0000 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.0133 - recall: 0.0275 - f1: 0.0179 - loss: 62.9297 
***** Entity results  *****
******* HC results ********
 acc: 0.0134 - recall: 0.0326 - f1: 0.0190 
******* HP results ********
 acc: 0.0000 - recall: 0.0000 - f1: 0.0000 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-167
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-167


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7622 - recall: 0.7803 - f1: 0.7711 - loss: 7.8362 
***** Entity results  *****
******* HC results ********
 acc: 0.7796 - recall: 0.8040 - f1: 0.7916 
******* HP results ********
 acc: 0.6636 - recall: 0.6518 - f1: 0.6577 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7814 - recall: 0.7906 - f1: 0.7859 - loss: 7.5138 
***** Entity results  *****
******* HC results ********
 acc: 0.8048 - recall: 0.8248 - f1: 0.8147 
******* HP results ********
 acc: 0.6429 - recall: 0.6050 - f1: 0.6234 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-334
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-334


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7580 - recall: 0.8275 - f1: 0.7912 - loss: 7.4742 
***** Entity results  *****
******* HC results ********
 acc: 0.7514 - recall: 0.8616 - f1: 0.8028 
******* HP results ********
 acc: 0.8090 - recall: 0.6429 - f1: 0.7164 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7661 - recall: 0.8403 - f1: 0.8015 - loss: 7.0981 
***** Entity results  *****
******* HC results ********
 acc: 0.7611 - recall: 0.8791 - f1: 0.8158 
******* HP results ********
 acc: 0.8065 - recall: 0.6303 - f1: 0.7075 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-501
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-501


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.8137 - recall: 0.7955 - f1: 0.8045 - loss: 6.3116 
***** Entity results  *****
******* HC results ********
 acc: 0.8234 - recall: 0.8221 - f1: 0.8228 
******* HP results ********
 acc: 0.7526 - recall: 0.6518 - f1: 0.6986 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.8309 - recall: 0.8168 - f1: 0.8238 - loss: 5.9692 
***** Entity results  *****
******* HC results ********
 acc: 0.8408 - recall: 0.8434 - f1: 0.8421 
******* HP results ********
 acc: 0.7692 - recall: 0.6723 - f1: 0.7175 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-668
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-668


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.8097 - recall: 0.8164 - f1: 0.8130 - loss: 6.7185 
***** Entity results  *****
******* HC results ********
 acc: 0.8196 - recall: 0.8386 - f1: 0.8290 
******* HP results ********
 acc: 0.7500 - recall: 0.6964 - f1: 0.7222 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7897 - recall: 0.8207 - f1: 0.8049 - loss: 6.5581 
***** Entity results  *****
******* HC results ********
 acc: 0.8032 - recall: 0.8481 - f1: 0.8250 
******* HP results ********
 acc: 0.7080 - recall: 0.6723 - f1: 0.6897 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-835
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-835


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 24


***** Eval results  *****
 acc: 0.7930 - recall: 0.8150 - f1: 0.8038 - loss: 7.4256 
***** Entity results  *****
******* HC results ********
 acc: 0.8143 - recall: 0.8237 - f1: 0.8190 
******* HP results ********
 acc: 0.6880 - recall: 0.7679 - f1: 0.7257 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 24


***** Eval results  *****
 acc: 0.7771 - recall: 0.8168 - f1: 0.7964 - loss: 7.2301 
***** Entity results  *****
******* HC results ********
 acc: 0.8072 - recall: 0.8310 - f1: 0.8189 
******* HP results ********
 acc: 0.6331 - recall: 0.7395 - f1: 0.6822 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1002
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-1002


Backbone bert_crf param is not freeze
