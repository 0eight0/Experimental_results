Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(adam_epsilon=1e-08, adv_epsilon=1.0, adv_name='word_embeddings', backbone='bert_crf', cache_dir='', config_name='', crf_learning_rate=0.001, data_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/', device=device(type='cuda'), do_adv=False, do_eval=False, do_lower_case=True, do_predict=False, do_train=True, enumerate_mode='attention', eval_all_checkpoints=False, eval_max_seq_length=512, evaluate_during_training=False, fp16=False, fp16_opt_level='O1', freeze_backbone_epoch=0, gradient_accumulation_steps=1, id2label={0: 'X', 1: 'B-HC', 2: 'B-HP', 3: 'I-HC', 4: 'I-HP', 5: 'O', 6: 'L-HC', 7: 'L-HP', 8: 'U-HC', 9: 'U-HP', 10: '[START]', 11: '[END]'}, id2tag={0: 'product', 1: 'brand'}, if_add_a_self_attention=True, if_merge_by_add=True, label2id={'X': 0, 'B-HC': 1, 'B-HP': 2, 'I-HC': 3, 'I-HP': 4, 'O': 5, 'L-HC': 6, 'L-HP': 7, 'U-HC': 8, 'U-HP': 9, '[START]': 10, '[END]': 11}, learning_rate=3e-05, local_rank=-1, logging_steps=-1, loss_type='ce', markup='bios', max_grad_norm=1.0, max_steps=-1, model_name_or_path='/mnt/storage/wubinghong.wbh/deepl/torch_ner/prev_trained_model/bert-base-chinese', n_gpu=1, no_cuda=False, num_train_epochs=10.0, output_dir='/mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=60, per_gpu_train_batch_size=60, pos_learning_rate=5e-05, predict_checkpoints=0, save_steps=-1, seed=42, tag2id={'product': 0, 'brand': 1}, tagging_rate=1.0, task_name='ecommerce', tokenizer_name='', train_max_seq_length=128, warmup_proportion=0.1, weight_decay=0.01)
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-train_bert-base-chinese_128_ecommerce
***** Running training *****
  Num examples = 3988
  Num Epochs = 10
  Instantaneous batch size per GPU = 60
  Total train batch size (w. parallel, distributed & accumulation) = 60
  Gradient Accumulation steps = 1
  Total optimization steps = 670
Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.6827 - recall: 0.6912 - f1: 0.6869 - loss: 11.6703 
***** Entity results  *****
******* HC results ********
 acc: 0.6837 - recall: 0.7941 - f1: 0.7348 
******* HP results ********
 acc: 0.6522 - recall: 0.1339 - f1: 0.2222 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7224 - recall: 0.7186 - f1: 0.7205 - loss: 11.6823 
***** Entity results  *****
******* HC results ********
 acc: 0.7195 - recall: 0.8233 - f1: 0.7679 
******* HP results ********
 acc: 0.8182 - recall: 0.1513 - f1: 0.2553 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-67
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-67


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7728 - recall: 0.7997 - f1: 0.7861 - loss: 8.0950 
***** Entity results  *****
******* HC results ********
 acc: 0.8019 - recall: 0.8204 - f1: 0.8111 
******* HP results ********
 acc: 0.6260 - recall: 0.6875 - f1: 0.6553 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7748 - recall: 0.8194 - f1: 0.7964 - loss: 7.9594 
***** Entity results  *****
******* HC results ********
 acc: 0.8009 - recall: 0.8419 - f1: 0.8209 
******* HP results ********
 acc: 0.6385 - recall: 0.6975 - f1: 0.6667 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-134
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-134


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7510 - recall: 0.8136 - f1: 0.7810 - loss: 8.2048 
***** Entity results  *****
******* HC results ********
 acc: 0.7582 - recall: 0.8369 - f1: 0.7956 
******* HP results ********
 acc: 0.7064 - recall: 0.6875 - f1: 0.6968 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7677 - recall: 0.8351 - f1: 0.8000 - loss: 8.0102 
***** Entity results  *****
******* HC results ********
 acc: 0.7889 - recall: 0.8574 - f1: 0.8217 
******* HP results ********
 acc: 0.6538 - recall: 0.7143 - f1: 0.6827 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-201
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-201


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7810 - recall: 0.7983 - f1: 0.7895 - loss: 7.5716 
***** Entity results  *****
******* HC results ********
 acc: 0.8069 - recall: 0.8056 - f1: 0.8063 
******* HP results ********
 acc: 0.6589 - recall: 0.7589 - f1: 0.7054 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7951 - recall: 0.8429 - f1: 0.8183 - loss: 7.5454 
***** Entity results  *****
******* HC results ********
 acc: 0.8286 - recall: 0.8543 - f1: 0.8412 
******* HP results ********
 acc: 0.6414 - recall: 0.7815 - f1: 0.7045 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-268
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-268


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7928 - recall: 0.7928 - f1: 0.7928 - loss: 8.0931 
***** Entity results  *****
******* HC results ********
 acc: 0.7968 - recall: 0.8204 - f1: 0.8084 
******* HP results ********
 acc: 0.7660 - recall: 0.6429 - f1: 0.6990 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.8151 - recall: 0.8312 - f1: 0.8231 - loss: 8.1467 
***** Entity results  *****
******* HC results ********
 acc: 0.8254 - recall: 0.8651 - f1: 0.8448 
******* HP results ********
 acc: 0.7476 - recall: 0.6471 - f1: 0.6937 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-335
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-335


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7391 - recall: 0.8234 - f1: 0.7789 - loss: 8.8526 
***** Entity results  *****
******* HC results ********
 acc: 0.7463 - recall: 0.8386 - f1: 0.7898 
******* HP results ********
 acc: 0.6975 - recall: 0.7411 - f1: 0.7186 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7520 - recall: 0.8534 - f1: 0.7995 - loss: 8.9204 
***** Entity results  *****
******* HC results ********
 acc: 0.7701 - recall: 0.8775 - f1: 0.8203 
******* HP results ********
 acc: 0.6515 - recall: 0.7227 - f1: 0.6853 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-402
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-402


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7633 - recall: 0.8164 - f1: 0.7890 - loss: 9.2353 
***** Entity results  *****
******* HC results ********
 acc: 0.7710 - recall: 0.8320 - f1: 0.8003 
******* HP results ********
 acc: 0.7193 - recall: 0.7321 - f1: 0.7257 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7695 - recall: 0.8390 - f1: 0.8028 - loss: 9.3315 
***** Entity results  *****
******* HC results ********
 acc: 0.7951 - recall: 0.8605 - f1: 0.8265 
******* HP results ********
 acc: 0.6370 - recall: 0.7227 - f1: 0.6772 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-469
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-469


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7631 - recall: 0.8289 - f1: 0.7947 - loss: 9.4800 
***** Entity results  *****
******* HC results ********
 acc: 0.7764 - recall: 0.8468 - f1: 0.8101 
******* HP results ********
 acc: 0.6891 - recall: 0.7321 - f1: 0.7100 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7651 - recall: 0.8482 - f1: 0.8045 - loss: 9.7306 
***** Entity results  *****
******* HC results ********
 acc: 0.7901 - recall: 0.8698 - f1: 0.8280 
******* HP results ********
 acc: 0.6350 - recall: 0.7311 - f1: 0.6797 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-536
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-536


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7456 - recall: 0.8275 - f1: 0.7844 - loss: 10.2175 
***** Entity results  *****
******* HC results ********
 acc: 0.7581 - recall: 0.8468 - f1: 0.8000 
******* HP results ********
 acc: 0.6750 - recall: 0.7232 - f1: 0.6983 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7503 - recall: 0.8455 - f1: 0.7951 - loss: 10.1982 
***** Entity results  *****
******* HC results ********
 acc: 0.7706 - recall: 0.8698 - f1: 0.8172 
******* HP results ********
 acc: 0.6391 - recall: 0.7143 - f1: 0.6746 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-603
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-603


Backbone bert_crf param is not freeze
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-dev_bert-base-chinese_512_ecommerce
***** Running evaluation on dev dataset  *****
  Num examples = 499
  Batch size = 60


***** Eval results  *****
 acc: 0.7709 - recall: 0.8192 - f1: 0.7943 - loss: 10.1172 
***** Entity results  *****
******* HC results ********
 acc: 0.7852 - recall: 0.8369 - f1: 0.8102 
******* HP results ********
 acc: 0.6923 - recall: 0.7232 - f1: 0.7074 
Loading features from cached file /mnt/storage/wubinghong.wbh/deepl/torch_ner/datasets/ecommerce/cached_crf-test_bert-base-chinese_512_ecommerce
***** Running evaluation on test dataset  *****
  Num examples = 497
  Batch size = 60


***** Eval results  *****
 acc: 0.7718 - recall: 0.8325 - f1: 0.8010 - loss: 10.1119 
***** Entity results  *****
******* HC results ********
 acc: 0.7954 - recall: 0.8558 - f1: 0.8245 
******* HP results ********
 acc: 0.6462 - recall: 0.7059 - f1: 0.6747 
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-670
Saving optimizer and scheduler states to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf/checkpoint-670


 global_step = 670, average loss = 7.004678059780775
Saving model checkpoint to /mnt/storage/wubinghong.wbh/deepl/torch_ner/outputs/ecommerce_output/bert_crf
